<div class="big-table-component" [id]="idFlag">
    <!-- demo -->
    <!-- <button nz-button nzType="default" (click)="sort('email','descend')">{{'sortEmail' | translate}}</button> -->
    <!-- 外部筛选 -->
    外部筛选：
    <button nz-button nzType="default" (click)="_filter('tf_query_id2','Gene ID2','equal','2',null)">truekey:tf_query_id2 name:Gene ID2 equal 2 </button>
    <button nz-button nzType="default" (click)="beginFilter()">开始筛选</button>
    <button nz-button nzType="default" (click)="refresh()">刷新</button>
    <br>
    <!-- 增删列 -->
    增删列：
    <button nz-button nzType="default" (click)="add1()">add => name age</button>
    <button nz-button nzType="default" (click)="add2()">add => age name</button>
    <button nz-button nzType="default" (click)="add3()">add => age</button>
    <button nz-button nzType="default" (click)="add4()">add => name</button>
    <!-- 一级筛选 -->
    <br>
    一级筛选：
    <button nz-button nzType="default"  (click)="_rootFilter('tf_query_id2','Gene ID2','filter','introduce',null)">Gendid2 introduce
    </button>
    <!-- 扩展功能  -->
    <br>
    表格转换：
    <button nz-button nzType="default"  (click)="toExtendTable()">确定</button>
    <button nz-button nzType="default" (click)="backToDefaultTable()">返回</button>
    <!-- 表格hover模板 -->
    <ng-template #popoverTpl>
        {{popoverText}}
    </ng-template>

    <hr>选中
    <em *ngFor="let item of checked">{{item}}&emsp;</em>
    <hr>未选中
    <em *ngFor="let item of unChecked">{{item}}&emsp;</em>
    <!-- table -->
    <!-- root filter items -->
    <div class="table-top" *ngIf="rootHtmlString.length">
        <span class="filter-head">{{'rootFilterTitle'| translate}}：</span>
        <span class="filter-item" (click)="deleteRootFilterItem(item)" *ngFor="let item of rootHtmlString" [innerHTML]="item['html']"></span>
    </div>
    <!-- child filter items -->
    <div class="table-top" *ngIf="filterHtmlString.length">
        <span class="filter-head">{{'childFilterTitle' | translate}}：</span>
        <span class="filter-item" (click)="deleteFilterItem(item)" *ngFor="let item of filterHtmlString" [innerHTML]="item['html']"></span>
    </div>
    <div class="table-content">
        <!-- [(nzPageIndex)]="pageIndex" [(nzPageSize)]="pageSize" (nzPageIndexChange)="getRemoteData()" (nzPageSizeChange)="getRemoteData(true)" x:head.length*150+'px'-->
        <nz-table *ngIf="dataSet.length && head.length && !error" #ajaxTable nzSize="small" [nzScroll]="{ x:totalWidth }" [nzData]="dataSet" [nzFrontPagination]='false' [nzShowPagination]="false" [nzTotal]="total" nzBordered [nzWidthConfig]="widthConfig">
            <thead>
                <tr>
                    <!-- checkbox -->
                    <th nzLeft="0px" [attr.rowspan]="twoLevelHead.length?2:1" nzShowCheckbox nzShowRowSelection [nzSelections]="selectMenu" [(nzChecked)]="allChecked" [nzIndeterminate]="indeterminate" (nzCheckedChange)="checkAll($event)"></th>
                    <!-- 首列 -->
                    <th style="text-align: center;" [attr.colspan]="head[0]['colspan']" [attr.rowspan]="head[0]['rowspan']" [nzLeft]="colLeftConfig[0]" [(nzSort)]="sortMap[head[0]['true_key']]" nzShowSort [nzSortKey]="head[0]['true_key']" (nzSortChange)="sort(head[0]['true_key'],$event)">
                        <span [nzTitle]="head[0]['hover']" nzPlacement="topCenter" nz-tooltip>{{head[0]['name']}}</span>
                        <!-- get app-filter child emit function <recive> <delete> -->
                        <app-filter #child *ngIf="beginFilterStatus" [pid]="idFlag" [searchType]="head[0]['searchType']" (getData)="recive($event)" (deleteData)="delete($event)" [filterNamezh]="head[0]['name']" [filterName]="head[0]['true_key']"></app-filter>
                    </th>
                    <!-- 其他列 -->
                    <th style="text-align: center;" [nzSortKey]="head[i+1]['true_key']" [(nzSort)]="sortMap[head[i+1]['true_key']]" (nzSortChange)="sort(head[i+1]['true_key'],$event)" [nzShowSort]="!head[i+1]['children'].length" [attr.colspan]="h['colspan']" [attr.rowspan]="h['rowspan']"
                        *ngFor="let h of head.slice(1);index as i;trackBy:identify">
                        <span [nzTitle]="head[i+1]['hover']" nzPlacement="topCenter" nz-tooltip>{{h['name']}}</span>
                        <app-filter #child *ngIf="beginFilterStatus && !h.children.length" [pid]="idFlag" [searchType]="head[i+1]['searchType']" (getData)="recive($event)" (deleteData)="delete($event)" [filterNamezh]="head[i+1]['name']" [filterName]="head[i+1]['true_key']"></app-filter>
                    </th>
                </tr>
                <tr ng-if="twoLevelHead.length">
                    <!-- 二级表头首列 -->
                    <th class="two-level-thead" style="text-align: center;" *ngFor="let h of twoLevelHead.slice(0,head[0].children.length);index as i;trackBy:identify" [nzLeft]="colLeftConfig[i]" [(nzSort)]="sortMap[h['true_key']]" nzShowSort [nzSortKey]="h['true_key']"
                        (nzSortChange)="sort(h['true_key'],$event)">
                        <span [nzTitle]="h['hover']" nzPlacement="topCenter" nz-tooltip>{{h['name']}}</span>
                        <app-filter #child *ngIf="beginFilterStatus" [pid]="idFlag" [searchType]="h['searchType']" (getData)="recive($event)" (deleteData)="delete($event)" [filterNamezh]="h['name']" [filterName]="h['true_key']"></app-filter>
                    </th>
                    <!-- 二级表头其他列 -->
                    <th style="text-align: center;" *ngFor="let h of twoLevelHead.slice(head[0].children.length);index as i;trackBy:identify" [(nzSort)]="sortMap[h['true_key']]" nzShowSort [nzSortKey]="h['true_key']" (nzSortChange)="sort(h['true_key'],$event)">
                        <span [nzTitle]="h['hover']" nzPlacement="topCenter" nz-tooltip>{{h['name']}}</span>
                        <app-filter #child *ngIf="beginFilterStatus" [pid]="idFlag" [searchType]="h['searchType']" (getData)="recive($event)" (deleteData)="delete($event)" [filterNamezh]="h['name']" [filterName]="h['true_key']"></app-filter>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let d of dataSet" style="text-align: center;">
                    <!-- checkbox -->
                    <td nzLeft="0px" nzShowCheckbox [(nzChecked)]="d.checked" (nzCheckedChange)="refreshStatus($event,d)"></td>
                    <!-- 首列的二级头表格数据 -->
                    <td *ngFor="let two of (head[0].children.length?head[0].children:[head[0]]);index as i;trackBy:identity" [nzLeft]="colLeftConfig[i]" (mouseover)="setPopoverText(d[two['true_key']])" [nzContent]="popoverTpl" nzPlacement="right" nz-popover>
                        {{d[two['true_key']]}}
                    </td>
                    <!-- 其他列 -->
                    <td *ngFor="let h of tbodyOutFirstCol" (mouseover)="setPopoverText(d[h['true_key']])" [nzContent]="popoverTpl" nzPlacement="right" nz-popover>
                        {{d[h['true_key']]}}
                    </td>
                </tr>
            </tbody>
        </nz-table>
        <div class="table-bottom">
            <nz-pagination [(nzPageIndex)]="pageIndex" [nzTotal]="total" [(nzPageSize)]="pageSize" (nzPageIndexChange)="getRemoteData()" (nzPageSizeChange)="getRemoteData(true)" nzShowSizeChanger nzShowQuickJumper></nz-pagination>
        </div>
        <app-error *ngIf="error" [error]="error"></app-error>
    </div>
</div>
